<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>魚文字アニメ（入力対応版）</title>
<style>
  body {
    margin: 0;
    overflow: hidden;
    background: linear-gradient(to bottom, #004080, #001f3f); /* 海っぽい青グラデーション */
    font-family: sans-serif;
  }
  .fish-text {
    position: absolute;
    font-size: 20px;
    color: #0ff;
    user-select: none;
    pointer-events: none;
    transition: transform 0.1s linear;
  }
  #input-container {
    position: fixed;
    bottom: 10px;
    left: 50%;
    transform: translateX(-50%);
    z-index: 1000;
  }
  #text-input {
    font-size: 16px;
    padding: 5px 10px;
  }
  #add-btn {
    font-size: 16px;
    padding: 5px 10px;
    margin-left: 5px;
  }
</style>
</head>
<body>

<div id="input-container">
  <input type="text" id="text-input" placeholder="文字を入力してEnter or 追加">
  <button id="add-btn">追加</button>
</div>

<script>
let texts = [];
let mouse = { x: -1000, y: -1000 };

// 文字を追加する関数
function addText(char) {
  const span = document.createElement("span");
  span.classList.add("fish-text");
  span.textContent = char;
  document.body.appendChild(span);

  texts.push({
    el: span,
    x: -20, // 左端からスタート
    y: Math.random() * window.innerHeight,
    speed: 1 + Math.random() * 2,
    offset: Math.random() * Math.PI * 2
  });
}

// 初期文字（ランダム）
const letters = "abcdefghijklmnopqrstuvwxyzあいうえお0123456789";
for (let i = 0; i < 40; i++) {
  addText(letters[Math.floor(Math.random() * letters.length)]);
}

// マウス位置更新
window.addEventListener("mousemove", e => {
  mouse.x = e.clientX;
  mouse.y = e.clientY;
});

// 入力対応
const input = document.getElementById("text-input");
const btn = document.getElementById("add-btn");
input.addEventListener("keydown", e => {
  if(e.key === "Enter" && input.value.trim() !== "") {
    input.value.split("").forEach(c => addText(c));
    input.value = "";
  }
});
btn.addEventListener("click", () => {
  if(input.value.trim() !== "") {
    input.value.split("").forEach(c => addText(c));
    input.value = "";
  }
});

// アニメーション
function animate() {
  texts.forEach(t => {
    // 左から右に移動
    t.x += t.speed;

    // 波の揺れ
    const wave = Math.sin(Date.now() / 200 + t.offset) * 5;

    // マウス回避
    const dx = t.x - mouse.x;
    const dy = t.y - mouse.y;
    const dist = Math.sqrt(dx*dx + dy*dy);
    if (dist < 100) {
      t.y += dy / dist * 3;
      t.x += dx / dist * 1;
    }

    // 画面ループ
    if (t.x > window.innerWidth + 20) {
      t.x = -20;
      t.y = Math.random() * window.innerHeight;
    }

    t.el.style.transform = `translate(${t.x}px, ${t.y + wave}px)`;
  });

  requestAnimationFrame(animate);
}

animate();
</script>
</body>
</html>
